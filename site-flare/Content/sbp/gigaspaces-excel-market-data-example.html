<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
<head></head>
<body>
<h1>GigaSpaces-Excel Market-Data Example</h1>
  

<table>
<thead>
<tr>
<th>Author</th>
<th>XAP Version</th>
<th>Last Updated</th>
<th>Reference</th>
<th>Download</th>
</tr>
</thead>

<tbody>
<tr>
<td>Pini Cohen</td>
<td>6.6</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<h1><a name="overview">&#160;</a>Overview</h1>

<p>This example shows the usage of Microsoft Excel spreadsheets and GigaSpaces XAP for working with stock market data. It also demonstrates the building of Excel RTD and UDF components in C# .NET. These components are integrated with Excel and work with the GigaSpaces XAP platform.</p>

<p>The example follows a common capital market use-case of managing market data flows. The market data flows are "wired" into the GigaSpaces XAP cluster, and Excel is notified of changes in the market data metrics.</p>

<p>The example demonstrates the following:</p>

<ul>
<li>Running GigaSpaces XAP with up-to-date stock market data.</li>
<li>Running Excel spreadsheets that show a view of the stock market data, and are updated almost in realtime; to show changes and updates in the market data.</li>
<li>Building and using Excel RTD and UDF components.</li>
</ul>

<div class="tc-admon-refer">
  
  <p>Getting Started with RTD and UDF? See the <a href="writing-your-first-rtd-or-udf-application.html">Writing Your First RTD/UDF Application</a> section and review the <a href="prerequisites-gigaspaces-excel-integration.html">prerequisites</a>.</p>
</div>

<h1><a name="example-structure">&#160;</a>Example Structure</h1>

<p>The example contains a few projects:</p>

<ul>
<li>The <code>StockEntities</code>project defines the <code>StockData</code> object, which stocks the market data with updated information.</li>
<li>The <code>StockQuote</code> project is in charge of notifying the Excel workbook of changes in the stock market data. <code>StockQuote</code> is an Excel RTD server. It receives GigaSpaces events when the stock market data is updated, and in turn notifies Excel of changes.</li>
<li>The <code>StockOperations</code> project is an Excel UDF (User-Defined Function). It returns the "Open" value of a Stock Symbol.</li>
<li>The <code>StockMarketFeeder</code> project writes the stock market data into the space. It simulates changes and actions that take place in the stock market.</li>
</ul>

 <a name="building">&#160;</a>

<h1><a name="building-the-example">&#160;</a>Building the Example</h1>

<p>Compile the .NET applications using <code>&lt;GigaSpaces Root&gt;\Examples\ExcelStocks\bin\compile.bat</code>.</p>

<p>The .NET files are created in the <code>&lt;Example Root&gt;\Release</code> directory.</p>

<h1><a name="adding-udf-function-to-excel">&#160;</a>Adding UDF Function to Excel</h1>

<ol>
<li>In Excel, go to <span class="tc-bold">Tools</span> &gt; <span class="tc-bold">add ins</span> &gt; <span class="tc-bold">automation</span>.</li>
<li>Scroll down to <span class="tc-bold">GigaSpaces.Examples.ExcelStocks.Operations.StockOperations</span>, select it and click <span class="tc-bold">OK</span>.</li>
</ol>

<div class="tc-align-center"><p><img src="/attachment_files/sbp/automation.jpg" alt="automation.jpg" /></p>
</div>

<ol>
<li>You might get a dialog at this point about mscoree.dll. Click No to this dialog (Yes will delete the add-in from the list).</li>
</ol>

<div class="tc-align-center"><p><img src="/attachment_files/sbp/mscoree_dll.jpg" alt="mscoree_dll.jpg" /></p>
</div>

<ol>
<li>Click <span class="tc-bold">OK</span> in the Add-ins dialog.</li>
</ol>

<div class="tc-align-center"><p><img src="/attachment_files/sbp/add-ins.jpg" alt="add-ins.jpg" /></p>
</div>

<h2><a name="opening-net-solution-with-microsoft-visual-studio">&#160;</a>Opening .NET Solution with Microsoft Visual Studio</h2>

<ol>
<li>Double-click the <code>ExcelStocks.sln</code> file, according to the version of Visual Studio you are using.</li>
<li>Choose <span class="tc-bold">Build</span> &gt; <span class="tc-bold">Build Solution</span>. The files: <code>StockEntities.dll</code>, <code>StockOperations.dll(UDF)</code>, <code>StockQuote.dll(RTD)</code> and <code>StockMarketFeeder.exe(Market feeder)</code>  are created in the <code>Release</code> subdirectory.</li>
</ol>

<h1><a name="running-the-example">&#160;</a>Running the Example</h1>

<p><span class="tc-iconexcl">&#160;</span> The example must be compiled before you run it (see <a href="#building">Building the Example</a> above).</p>

<ol>
<li>Start the GigaSpaces environment: <code>&lt;Example Root&gt;\bin\startAll.bat</code>.</li>

<li><p>Run the GigaSpaces Management Center <code>(&lt;GigaSpaces Root&gt;\Bin\Gs-ui.exe</code>) to see the  <code>GigaSpaces.Examples.ExcelStocks.StockEntities.StockData</code>` instances. To view only the relevant spaces:</p>

<ol>
<li>In the top menu bar, choose <span class="tc-bold">Settings</span> &gt; <span class="tc-bold">Discovery</span> &gt; <span class="tc-bold">Group management</span>.</li>
<li>Select only the <span class="tc-bold">Excel</span> group, unselect all the rest.</li>
</ol></li>

<li><p>Open the Excel file <code>&lt;Example Root&gt;\Chart.xls</code>.</p></li>
</ol>

<h1><a name="example-scripts">&#160;</a>Example Scripts</h1>

<p>The example includes the following scripts:</p>

<ul>
<li><code>compile.bat</code> - compiles the .NET components.</li>
<li><code>startAll.bat</code> - runs the feeder process that starts an embedded space and fills the space with stock market data updates. These updates trigger RTD calls, and are presented in realtime in the open Excel workbook.</li>
</ul>

<h1><a name="tested-configuration">&#160;</a>Tested Configuration</h1>

<ul>
<li>OS client – Windows XP, SP2 and onwards</li>
<li>.NET client – MS .NET Framework 2</li>
<li>Excel – Office 2003 Professional</li>
<li>GigaSpaces XAP.NET 6.6</li>
</ul>

<h1><a name="tested-performance-metrics">&#160;</a>Tested Performance Metrics</h1>

<p>The following metrics describe the scope of testing performed using the examples from above. The solution is known to be working with these numbers. It should be noted that these metrics are not an upper boundary. It is recommended that any deviation beyond these numbers first be verified with GigaSpaces PM and/or RND.</p>

<ul>
<li>Excel 2003 clients</li>
<li>Up to 50 concurrent remote Excel clients (5 machines, 10 clients on each machine).</li>
<li>Up to 200 space-related Excel cells (RTD) in a single spreadsheet.</li>
<li>Up to 200 events per second pushed from the space to Excel.</li>
<li>Object sizes of up to 10K.</li>
<li>Maximum heap size of embedded Excel JVM - 64M.</li>
</ul>

<p><span class="tc-iconexcl">&#160;</span> A .NET local cache on the Excel side is not supported.</p>

<div class="tc-admon-refer">
  
  <p>Back to The <a href="excel-that-scales-solution.html">Excel that Scales Solution</a> section.</p>
</div>

</body>
</html>