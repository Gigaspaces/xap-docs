<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
<head></head>
<body>
<h1>Writing Your First RTD or UDF Application</h1>
  

<h1><a name="overview">&#160;</a>Overview</h1>

<p>This section shows you how to write your first RTD or UDF application using the GigaSpaces-Excel integration.</p>

<p>Please read the <a href="prerequisites-gigaspaces-excel-integration.html">XAP-Excel integration prerequisites</a> before you proceed.</p>

<div class="tc-admon-refer">
  
  <p>See some basic and advanced code examples for <a href="rtd-and-udf-examples-gigaspaces-excel-integration.html">working with UDF and RTD</a>.</p>
</div>

<h1><a name="writing-your-first-rtd-udf-application">&#160;</a>Writing Your First RTD/UDF Application</h1>

<ol>
<li>In Visual Studio, create 2 new <span class="tc-bold">Class Library</span> projects, one for UDF and one for RTD.</li>
<li>Add the <code>&lt;GigaSpaces Root&gt;\Bin\GigaSpaces.Core.dll</code> reference.</li>
<li>In the <span class="tc-bold">COM</span> tab, select <span class="tc-bold">Microsoft Excel 11.0 Object Library</span>.</li>
<li>In the <span class="tc-bold">.NET</span> tab, select <span class="tc-bold">System.configuration</span>.</li>

<li><p>Office runtime:</p>

<ul>
<li>For Excel 2003 - in the <span class="tc-bold">COM</span> tab, add the <span class="tc-bold">Microsoft Office 11.0 Object Library</span>.</li>
<li>For Excel 2007 - in the <span class="tc-bold">COM</span> tab, add the <span class="tc-bold">Microsoft Office 12.0 Object Library</span>.</li>
</ul></li>

<li><p>Build the projects.</p></li>

<li><p>Make sure <code>GigaSpaces.Core.dll</code> and <code>GigaSpaces.NetToJava.dll</code> exist in your <code>Release</code> folder.</p></li>

<li><p>Run the following command from the <code>Release</code> folder:
<code>%WinDir%\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe \[MY_RTD_CLASSNAME\].dll /Codebase</code></p></li>

<li><p>Save the <a href="/download_files/sbp/excel.exe.config">excel.exe.config</a> file in your Excel runtime folder. For example: <code>C:\Program Files\Microsoft Office\OFFICE11</code></p></li>

<li><p>Open Excel.</p></li>

<li><p>To add the UDF function:</p>

<ol>
<li>In Excel, go to <span class="tc-bold">Tools</span> &gt; <span class="tc-bold">add ins</span> &gt; <span class="tc-bold">automation</span>.</li>
<li>Scroll down to <span class="tc-bold">[MY_UDF_CLASSNAME]</span>, select it and click <span class="tc-bold">OK</span>. You might get a dialog at this point about mscoree.dll. Click No to this dialog (Yes will delete the add-in from the list).</li>
</ol></li>

<li><p>Start a space: <code>&lt;GigaSpaces Root&gt;\Bin\Gs-ui.exe</code>.</p></li>

<li><p>To call a UDF, click the <span class="tc-bold">Function</span> icon, and look for the <span class="tc-bold">[MY_UDF_CLASSNAME]</span> functions.</p></li>
</ol>

<ul>
<li>To call a RTD, write in any Excel cell:
<code>=RTD("[MY PROG ID]",,[MY PARAMETERS])</code></li>
</ul>

<h1><a name="what-s-next">&#160;</a>What's Next?</h1>

<div class="tc-admon-refer">
  
  <p>See the <a href="gigaspaces-excel-market-data-example.html">GigaSpaces-Excel Market-Data Example</a>.
Back to The <a href="excel-that-scales-solution.html">Excel that Scales Solution</a> section.</p>
</div>

</body>
</html>