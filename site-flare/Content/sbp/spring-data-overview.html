<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
<head></head>
<body>
<h1>XAP Support</h1>
  

<p>When developing an XAP application using Spring we need to configure a connection to the active Space inside the Spring IoC container. We will show you how a basic connection can be created using XML or Java based Spring configurations.</p>

<p>You can start an <code>Embedded Space</code> or set up a <code>Service Grid</code>. When using the <a href="/xap/14.0/started/xap-tutorial-part1.html">Embedded Space</a> you don't need to start any additional processes in your environment.</p>

<p>To start the Data Grid use the following command:</p>

<div class="easyui-tabs" plain="true" data-options=""><div title=" Windows" style="padding:10px"><pre><code class="language-bash">gs-agent.bat
gs.bat deploy-space -cluster total_members=1,1 space
</code></pre>
</div>
<div title=" Unix" style="padding:10px"><pre><code class="language-bash">./gs-agent.sh
./gs.sh deploy-space -cluster total_members=1,1 space
</code></pre>
</div>
</div>

<div class="tc-admon-refer">
  
  <p>Refer to <a href="/xap/14.0/started/xap-in-5-minutes.html">XAP Quick Start guide</a> for more information.</p>
</div>

<p>In your project (assuming you build it with <a href="http://maven.apache.org/">Maven</a>) add the following to the <code>pom.xml</code> dependencies section:</p>

<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;!-- other dependency elements omitted --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;
        &lt;artifactId&gt;spring-data-xap&lt;/artifactId&gt;
        &lt;version&gt;1.0.0.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>

<h1><a name="space-connection-with-xml-metadata">&#160;</a>Space Connection with XML metadata</h1>

<p>To use the XAP Repository you need to provide a connection to the Space with an instance of <code>GigaSpace</code>. This can be configured with the Spring XML configuration:</p>

<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="
         http://www.openspaces.org/schema/core
         http://www.openspaces.org/schema/10.1/core/openspaces-core.xsd
         http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"&gt;

  &lt;!-- A bean representing space proxy (requires active data grid with the same name) --&gt;
  &lt;os-core:space-proxy id="space" name="space"/&gt;

  &lt;!-- GigaSpace interface implementation used for SpaceClient injection --&gt;
  &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;

&lt;/beans&gt;
</code></pre>

<p>If you want to use an <code>Embedded Space</code>, use the following configuration:</p>

<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="
         http://www.openspaces.org/schema/core
         http://www.openspaces.org/schema/10.1/core/openspaces-core.xsd
         http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"&gt;

  &lt;!-- A bean representing an embedded space --&gt;
  &lt;os-core:embedded-space id="space" name="space"/&gt;

  &lt;!-- GigaSpace interface implementation used for SpaceClient injection --&gt;
  &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;

&lt;/beans&gt;
</code></pre>

<h1><a name="space-connection-with-java-metadata">&#160;</a>Space Connection with Java metadata</h1>

<p>The same configuration can be achieved with Java-based bean metadata:</p>

<pre><code class="language-java">@Configuration
public class ContextConfiguration {
    /**
     * Builds a space instance with settings that allow it to connect to the 'space'.
     */
    @Bean
    public GigaSpace space() {
        UrlSpaceConfigurer urlSpaceConfigurer = new UrlSpaceConfigurer("jini://*/*/space");
        return new GigaSpaceConfigurer(urlSpaceConfigurer).gigaSpace();
    }
}
</code></pre>

<p>Using an Embedded Space:</p>

<pre><code class="language-java">@Configuration
public class ContextConfiguration {
    /**
     * Builds a space instance with settings that allow it start the embedded space with name 'space'.
     */
    @Bean
    public GigaSpace space() {
        UrlSpaceConfigurer urlSpaceConfigurer = new UrlSpaceConfigurer("/./space");
        return new GigaSpaceConfigurer(urlSpaceConfigurer).gigaSpace();
    }
}
</code></pre>

<h1><a name="other-space-configurations">&#160;</a>Other Space configurations</h1>

<p>In some projects you might want to apply other configurations to the Space. There are several options available:</p>

<h2><a name="local-cache">&#160;</a>Local cache</h2>

<p>A <code>Local Cache</code> is a Client Side Cache that maintains a subset of the master Space's data based on the client application's recent activity. The local cache is created empty, and whenever the client application executes a query the local cache first tries to fulfill it from the cache, otherwise it executes it on the master Space and caches the result locally for future queries.</p>

<div class="tc-admon-refer">
  
  <p>To find out more about Local Cache and it's configuration, refer to <a href="/xap/14.0/dev-java/local-cache.html">Local Cache Reference</a>.</p>
</div>

<h2><a name="local-view">&#160;</a>Local view</h2>

<p>A <code>Local View</code> is a Client Side read only Cache that maintains a subset of the master space's data, allowing the client to read distributed data without performing any remote calls or data serialization. Data is streamed into the client local view based on predefined criteria (a collection of SQLQuery objects) specified by the client when the local view is created.</p>

<div class="tc-admon-refer">
  
  <p>To read more on Local View, refer to <a href="/xap/14.0/dev-java/local-view.html">Local View Reference</a>.</p>
</div>

<h2><a name="space-persistence">&#160;</a>Space Persistence</h2>

<p>Space Persistence is a configuration where Space data is persisted into permanent storage and retrieved from it.</p>

<div class="tc-admon-refer">
  
  <p>Read more on persisting Space data <a href="/xap/14.0/started/xap-tutorial-part7.html">here</a>.</p>
</div>

<h2><a name="space-security">&#160;</a>Space Security</h2>

<p>XAP Security provides comprehensive support for securing your data and Space operations  or both. XAP provides a set of authorities granting privileged   to access data and for performing operations on the Space.</p>

<div class="tc-admon-refer">
  
  <p>To find out more about security configuration,  refer to <a href="/xap/14.0/security">Security Guide</a>.</p>
</div>

<h1><a name="using-native-write-and-read-operation">&#160;</a>Using native write and read operation</h1>

<p><code>GigaSpace</code> configured above can be used directly to perform interaction with the Space. To do so,  simply inject the <code>GigaSpace</code> bean into your Repository classes. Here is an example, we have a <code>Person Repository</code> that defines the basic operations:</p>

<div class="easyui-tabs" plain="true" data-options=""><div title=" Person" style="padding:10px"><pre><code class="language-java">@SpaceClass
public class Person {
    private Integer id;
    private String name;
    private Integer age;

    public Person() {
    }

    @SpaceId(autoGenerate = true)
    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    // getters and setters for other fields are omitted

}
</code></pre>
</div>
<div title=" Repository" style="padding:10px"><pre><code class="language-java">@Repository
public class XapPersonRepository implements PersonRepository {

    // GigaSpace can be injected and used directly in Repository layer

    @Autowired
    private GigaSpace space;

    public void create(Person person) {
        space.write(person);
    }

    public List&lt;Person&gt; findById(String personId) {
        return space.readById(Person.class, personId);
    }
    ...
}
</code></pre>
</div>
</div>

<div class="tc-admon-note">
  
  <p>The class is marked with <code>@SpaceClass</code> annotation - it allows Spring XAP to look for entities in your data model and automatically handle their structure. Also, the <code>getId()</code> method is marked with <code>@SpaceId(autogenerate = true)</code> annotation - it will tell the space to handle ids automatically.</p>
</div>

<h1><a name="modeling-your-data">&#160;</a>Modeling your data</h1>

<p>Spring Data XAP comes with the transparent support of XAP native features. Additional configurations can be applied to your POJOs to boost the performance and reduce memory usage. When building the data model using Spring Data XAP you might want to consider some of the following features:</p>

<h2><a name="indexing">&#160;</a>Indexing</h2>

<p>The most well-known data store function that allows to boost common queries performance is index support. XAP provides several options: basic, compound and unique indexes. All of these features can be applied by simply annotating POJO classes or their fields, e.g. with <code>@SpaceIndex</code> or <code>@CompoundSpaceIndex</code> annotations.</p>

<div class="tc-admon-refer">
  
  <p>Please, refer to <a href="/xap/14.0/dev-java/indexing-overview.html">Indexing</a> for more details and examples of POJO classes.</p>
</div>

<h2><a name="storage-types">&#160;</a>Storage Types</h2>

<p>You can define the form in which objects will be stored in Space either with annotations on each POJO in your model or with defining default Storage Type for the  Space. This is done to save up time on serialization/de-serialization, reduce memory usage or to define schema that will change in time. Three Storage Types are available for POJOs: <code>OBJECT</code>, <code>BINARY</code> and <code>COMPRESSED</code>.</p>

<div class="tc-admon-refer">
  
  <p>To read more on this feature, please, refer to <a href="/xap/14.0/dev-java/storage-types-controlling-serialization.html">Storage Types</a>.</p>
</div>

<h2><a name="exclusion">&#160;</a>Exclusion</h2>

<p>You can mark some POJO properties with <code>@SpaceExclude</code> to disable writing their values to the Space. It will also affect Querydsl <code>Q...</code> classes generation from POJOs - marked fields won't be available for querying in <code>Querydsl</code> style.</p>

<h2><a name="other-annotation-based-features">&#160;</a>Other Annotation-based Features</h2>

<div class="tc-admon-refer">
  
  <p>For the full list of available annotations, please, refer to <a href="/xap/14.0/dev-java/pojo-annotation-overview.html">Annotation based Metadata</a>.</p>
</div>

</body>
</html>