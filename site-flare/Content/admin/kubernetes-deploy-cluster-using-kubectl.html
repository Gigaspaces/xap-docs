<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1 class="tc-pagetitle"><a name="deploying-a-space-cluster"></a>Deploying a Space Cluster in Kubernetes Using <code>kubectl</code></h1>
        <p>GigaSpaces uses the Custom Resources Definition (CRD) feature of Kubernetes to define a resource type called Processing Unit. With a properly defined <code>yaml</code> file, the <code> kubectl apply</code> command can be used to deploy a GigaSpaces Processing Unit.</p>
        <p>For example, in the command line type the <code>kubectl apply</code>command to deploy a Space cluster with four primaries and four backups. </p>
        <p>Note the highlighted entries in the <code>yaml </code>file:</p>
        <ul>
            <li><span class="tc-highlight">kind: ProcessingUnit</span>
                <ul>
                    <li>
                        <p>Specifies the Processing Unit custom resource type</p>
                    </li>
                </ul>
            </li>
            <li>
                <p><span class="tc-highlight">partitions: 4</span>
                </p>
                <ul>
                    <li>
                        <p>Four primary instances are deployed</p>
                    </li>
                </ul>
            </li>
            <li>
                <p><span class="tc-highlight">ha: true</span>
                </p>
                <ul>
                    <li>
                        <p>Four additional backup instances are deployed</p>
                    </li>
                </ul>
            </li>
            <li>
                <p><span class="tc-highlight">antiAffinity: true</span>
                </p>
                <ul>
                    <li>
                        <p>Applicable only if <code>ha: true</code>) If this option is set to <code>true</code>, then the four backup instances will each be deployed on different hosts from their primary instance.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <p>Enter the following command to deploy the Processing Unit:</p>
        <div class="tc-admon-note">
            <p>The Processing Unit  will use one stateful set per stateful pu.</p>
        </div><pre><code class="language-bash">kubectl apply -f filename.yaml</code></pre>
        <div class="easyui-accordion">
            <div title="">
                <p>Click below to see the sample  <code>yaml</code> file.</p>
            </div>
            <div title="Sample yaml file">
                <p>apiVersion: gigaspaces.com/v1</p>
                <p><span class="tc-highlight">kind: ProcessingUnit</span>
                </p>
                <p>metadata :</p>
                <p>name: data-processor</p>
                <p>namespace: default</p>
                <p>spec :</p>
                <p><span class="tc-highlight">partitions: 4</span>
                </p>
                <p><span class="tc-highlight">ha: true</span>
                </p>
                <p><span class="tc-highlight">antiAffinity: true</span>
                </p>
                <p>image:</p>
                <p>repository: gigaspaces/xap-enterprise</p>
                <p>tag: 16.1.0</p>
                <p>javaHeap: limit-150Mi</p>
                <p>license: tryme</p>
                <p>manager:</p>
                <p>name: testmanager</p>
                <p>ports :</p>
                <p>api: 8090</p>
                <p>multiCast: false</p>
                <p>productType: xap</p>
                <p>properties: image.tag=16.1.0;image.repository=gigaspaces/xap-enterprise;pu.dynamic-partitioning=true</p>
                <p>resourceUrl: https://demo-gs.s3.eu-west-1.amazonaws.com/data-processor.jar</p>
                <p>resources :</p>
                <p> limits :</p>
                <p> cpu: null</p>
                <p>memory: 550Mi</p>
                <p>requests: null</p>
            </div>
        </div>
        <p>Enter the following command to see the status of the Processing Units:</p>
        <div class="tc-admon-note">
            <p>The Processing Unit  will use one stateful set per stateful pu.</p>
        </div><pre><code class="language-bash">kubectl get pus</code></pre>
        <div class="easyui-accordion">
            <div title="">
                <p>Sample output appears as follows:</p>
                <p>
                    <img src="../Resources/Static/images/kubernetes-sample-get-pus.png" />
                </p>
            </div>
        </div>
        <p>Enter the following command to delete a Processing Unit:</p><pre><code class="language-bash">kubectl delete pu <i>name-of-processing-unit</i></code></pre>
    </body>
</html>