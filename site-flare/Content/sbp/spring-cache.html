<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
<head></head>
<body>
<h1>Spring Cache Abstraction with XAP</h1>
  

<table>
<thead>
<tr>
<th>Author</th>
<th>XAP Version</th>
<th>Last Updated</th>
<th>Reference</th>
<th>Download</th>
</tr>
</thead>

<tbody>
<tr>
<td>Ali Hodroj<br/>Director of Solution Architecture GigaSpaces</td>
<td>9.7</td>
<td>October 2014</td>
<td><a href="http://docs.spring.io/spring-framework/docs/4.0.x/spring-framework-reference/html/cache.html">Spring Framework</a></td>
<td><a href="https://github.com/GigaSpaces-ProfessionalServices/spring-cache-abstraction">Github link</a></td>
</tr>
</tbody>
</table>

<h1><a name="introduction">&#160;</a>Introduction</h1>

<p>Since version 3.1, the <code>Spring Framework</code> provides support for transparently adding caching to an existing <code>Spring</code> application through method annotations. As is the case with transaction support, the caching abstraction decouples caching implementation from the business logic. This article shows how to utilize the XAP CacheManager with Spring that implements the following distributed caching scenario:</p>

<table>
<thead>
<tr>
<th><span class="tc-bold">Distributed cache</span></th>
<th><span class="tc-bold">Distributed cache + local cache</span></th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="/attachment_files/springcache/spring-cache1.png" alt="scaling_agent.jpg" /></td>
<td><img src="/attachment_files/springcache/spring-cache2.png" alt="scaling_agent.jpg" /></td>
</tr>
</tbody>
</table>

<p><span class="tc-bold">Benefits when using XAP as a Spring caching provider</span></p>

<ul>
<li><span class="tc-bold">Decreased Latency</span> –  Ability to utilize local cache across all server instances for localized reads, greatly reducing serialization across the wire</li>
<li><span class="tc-bold">Scalability</span> – Horizontally scalable and partitioned cache with flexible cache entry routing</li>
<li><span class="tc-bold">High Availability</span> – Each partition has a backup instance deployable on a different JVM, host, or availability zone.</li>
</ul>

<h1><a name="configuring-the-cache-storage">&#160;</a>Configuring the Cache Storage</h1>

<p>The XAP cache manager is located under <code>org.openspaces.cacheable</code> package. To use it, you simply declare the <code>GigaSpacesCacheManager</code> as the cacheManager bean. In addition, the “space” property must be set to specify the URI of the XAP cache.</p>

<pre><code class="language-xml">&lt;cache:annotation-driven /&gt;
&lt;bean id="cacheManager" class="org.openspaces.cacheable.GigaSpacesCacheManager"&gt;
    &lt;property name="space" value="jini://*/*/space" /&gt;
&lt;/bean&gt;
</code></pre>

<h2><a name="declarative-annotation-based-caching">&#160;</a>Declarative Annotation-based Caching</h2>

<p>Spring provides two annotations for caching declaration and eviction: <code>@Cacheable</code> and <code>@CacheEvict</code>. The <code>@Cacheable</code> annotation will trigger a cache put, while <code>@CacheEvict</code> will clear all space entries associated with a given cache:</p>

<pre><code class="language-java">@Cacheable("books")
public Book findBook(ISBN isbn) {...}

@CacheEvict(value = "books", allEntries=true)
public void loadBooks(InputStream batch)
</code></pre>

<h2><a name="data-locality-with-a-local-cache-highest-performance">&#160;</a>Data-locality with a local cache (highest performance)</h2>

<p>Since most cache queries in Spring are ID-based lookups, the performance can be dramatically improved by utilizing the <a href="/xap/14.0/dev-java/local-cache.html">Local Cache</a> feature of XAP.</p>

<p>Here is an example how to configure the Local Cache:</p>

<pre><code class="language-xml">&lt;cache:annotation-driven /&gt;
&lt;bean id="cacheManager" class="org.openspaces.cacheable.GigaSpacesCacheManager"&gt;
   &lt;property name="space" value="jini://*/*/space" /&gt;
   &lt;property name="localCache" value="true" /&gt;
&lt;/bean&gt;
</code></pre>

</body>
</html>