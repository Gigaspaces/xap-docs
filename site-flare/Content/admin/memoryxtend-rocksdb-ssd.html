<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1 class="tc-pagetitle">MemoryXtend for Disk (SSD/HDD)</h1>
        <h1><a name="overview"></a>Overview</h1>
        <p>The MemoryXtend disk storage driver delivers built-in, high-speed persistence that leverages local or attached SSD devices, all-flash-arrays (AFA), or any other disk or memory option. It delivers low latency write and read performance, as well as fast data recovery.  The MemoryXtend disk storage driver is based on <a href="http://rocksdb.org/" target="_blank">RocksDB</a>, which is a persistent key/value store optimized for fast storage environments.</p>
        <h2><a name="architecture-and-components"></a>Architecture and Components</h2>
        <p>When configured for the disk storage driver, the MemoryXtend architecture tiers the storage of each Space partition instance across two components: a Space partition instance (managed JVM heap) and an embedded key/value store (the blobstore) as shown in the diagram below.</p>
        <div class="tc-align-center">
            <p>
                <img src="../Resources/Static/attachment_files/blobstore/memoryxtend-rocksdb-architecture.png" alt="image" class="tc-picture80" />
            </p>
        </div>
        <div class="tc-admon-note">
            <p><MadCap:variable name="General.ProductNameIE" /> and <MadCap:variable name="General.ProductNameXAP" /> require Read/Write permissions to mounted devices/partitions.</p>
        </div>
        <h3><a name="space-partition-instance"></a>Space Partition Instance</h3>
        <p>The Space partition instance is a JVM heap that acts as an LRU cache against the underlying blobstore. This tier in the architecture stores indexes, Space class metadata, transactions, replication redo logs, leases, and statistics.
Upon a Space read operation, if the object exists in the JVM heap (i.e. a cache <i>hit</i>) it is immediately returned to the Space proxy client. Otherwise, the Space loads it from the underlying blobstore and places it on the JVM heap (known as a cache <i>miss</i>).</p>
        <h3><a name="blobstore"></a>Blobstore</h3>
        <p>The blobstore is based on a log-structured merge tree architecture (similar to popular NoSQL databases such as: <a href="https://hbase.apache.org/" target="_blank">HBase</a>, <a href="https://cloud.google.com/bigtable/" target="_blank">BigTable</a>, or <a href="https://cassandra.apache.org/" target="_blank">Cassandra</a>). There are four main components in the blobstore:</p>
        <ul>
            <li><span class="tc-bold">MemTable</span>: An in-memory data structure (residing on off-heap RAM) where all incoming writes are stored. When a MemTable fills up, it is flushed to an SST file on storage.</li>
            <li><span class="tc-bold">Log</span>: A write-ahead log (WAL) that serializes MemTable operations to a persistent medium as log files. In the event of failure, WAL files can be used to recover the key/value store to its consistent state, by reconstructing the MemTable from the logs.</li>
            <li><span class="tc-bold">Sorted String Table (SST) files</span>: SSTable is a data structure (residing on disk) that efficiently stores a large data footprint while optimizing for high throughput, and sequential read/write workloads. When a MemTable fills up, it is flushed to an SST file on storage and the corresponding WAL file can be deleted.</li>
            <li><span class="tc-bold">Built-in Cache</span>: MemoryXtend comes with a built-in cache. This cache is part of the Space partition tier, and stores objects in their native form.</li>
        </ul>
        <h1><a name="basic-configuration"></a>Basic Configuration</h1>
        <p>Any existing Space can be configured to integrate a blobstore with it. As with a typical Processing Unit, configuration is done using either the <code>pu.xml</code> configuration file, or in the code. For example:</p>
        <div class="easyui-tabs" plain="true" data-options="">
            <div title="Namespace" style="padding:10px"><pre MadCap:conditions="Version.14-5-died"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns:blob-store="http://www.openspaces.org/schema/rocksdb-blob-store"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-[%=Versions.spring-short%].xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd
       http://www.openspaces.org/schema/rocksdb-blob-store http://www.openspaces.org/schema/[%=Versions.product-version-short%]/rocksdb-blob-store/openspaces-rocksdb-blobstore.xsd"&gt;

    &lt;blob-store:rocksdb-blob-store id="rocksDbBlobstore" paths="[/mnt/db1,/mnt/db2]" mapping-dir="/tmp/mapping"/&gt;

    &lt;os-core:embedded-space id="space" space-name="mySpace" &gt;
        &lt;os-core:blob-store-data-policy blob-store-handler="rocksDbBlobstore" persistent="true"/&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre>
            </div>
            <div title="Plain XML" style="padding:10px"><pre MadCap:conditions="Version.14-5-only"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd"&gt;

    &lt;bean id="rocksDbBlobstore" class="com.gigaspaces.blobstore.rocksdb.config.RocksDBBlobStoreDataPolicyFactoryBean"&gt;
        &lt;property name="paths" value="[/mnt/db1,/mnt/db2]"/&gt;
        &lt;property name="mappingDir" value="/tmp/mapping"/&gt;		
	  &lt;/bean&gt;

    &lt;os-core:embedded-space id="space" space-name="mySpace"&gt;
        &lt;os-core:blob-store-data-policy blob-store-handler="rocksDbBlobstore" persistent="true"/&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre><pre MadCap:conditions="Version.15-0-born"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"xmlns:blob-store="http://www.openspaces.org/schema/rocksdb-blob-store"
       xmlns:blob-store="http://www.openspaces.org/schema/rocksdb-blob-store"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd
       http://www.openspaces.org/schema/rocksdb-blob-store http://www.openspaces.org/schema/[%=Versions.product-version-short%]/rocksdb-blob-store/openspaces-rocksdb-blobstore.xsd"&gt;

    &lt;blob-store:rocksdb-blob-store id="rocksDbBlobstore" persistent="true"/&gt;

    &lt;os-core:embedded-space id="space" space-name="mySpace"&gt;
        &lt;os-core:blob-store-data-policy blob-store-handler="rocksDbBlobstore"/&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre>
            </div>
            <div title="Java Code" style="padding:10px"><pre MadCap:conditions="Version.15-0-died"><code class="language-java">// Create RocksDB storage driver:
BlobStoreStorageHandler blobStore = new RocksDBBlobStoreConfigurer()
        .setPaths("[/mnt/db1,/mnt/db2]")
        .setMappingDir("/tmp/mapping")
        .create();
// Create space with that storage driver:
EmbeddedSpaceConfigurer spaceConfigurer = new EmbeddedSpaceConfigurer("mySpace")
        .cachePolicy(new BlobStoreDataCachePolicy()
                .setBlobStoreHandler(blobStore)
                .setPersistent(true));
GigaSpace gigaSpace = new GigaSpaceConfigurer(spaceConfigurer).gigaSpace();
					</code></pre><pre MadCap:conditions="Version.15-0-born"><code class="language-java">// Create RocksDB storage driver:
BlobStoreStorageHandler blobStore = new RocksDBBlobStoreConfigurer()
        .setPersistent(true)
        .create();
// Create space with that storage driver:
EmbeddedSpaceConfigurer spaceConfigurer = new EmbeddedSpaceConfigurer("mySpace")
        .cachePolicy(new BlobStoreDataCachePolicy()
                .setBlobStoreHandler(blobStore));
GigaSpace gigaSpace = new GigaSpaceConfigurer(spaceConfigurer).gigaSpace();
					</code></pre>
            </div>
        </div>
        <div class="tc-admon-attention" MadCap:conditions="Version.14-5-only">
            <p>The above pu.xml example is relevant only for the service grid environment. For information on how to configure the pu.xml for a Kubernetes environment, see Persistent Volume Storage in Kubernetes below.</p>
        </div>
        <div class="tc-admon-note" MadCap:conditions="Version.15-0-born">
            <p>If you're using Kubernetes, additional configuration may be required. See Persistent Volume Storage in Kubernetes below.</p>
        </div>
        <p><a name="The"></a>The following table describes the <a name="configuration-options">configuration options</a> used in <code>rocksdb-blob-store</code> above.</p>
        <table>
            <thead>
                <tr>
                    <th align="left">Property</th>
                    <th align="left">Description</th>
                    <th align="left">Default</th>
                    <th align="left">Use</th>
                </tr>
            </thead>
            <tbody>
                <tr MadCap:conditions="Version.15-0-born">
                    <td align="left"><a name="ssd-persistent"></a>persistent</td>
                    <td align="left">If true, the space will load persisted data when started. Otherwise, the space will purge persisted data and start empty.</td>
                    <td align="left">&#160;</td>
                    <td align="left">required</td>
                </tr>
                <tr MadCap:conditions="Version.15-0-born">
                    <td align="left">main-path</td>
                    <td align="left">
                        <p align="left"> Specify the main path in which all necessary sub directories are created automatically (instance data and metadata).</p>
                    </td>
                    <td align="left">
                        <p align="left">persistent: <code>$GS_HOME/work/memoryxtend/rocksdb</code></p>
                        <p align="left">transient: processing unit working folder</p>
                    </td>
                    <td align="left">optional</td>
                </tr>
                <tr>
                    <td align="left">paths</td>
                    <td align="left">
                        <p align="left">A comma-separated array of mount paths used for each Space partition's blobstore. The number of paths in the array should correspond to the number of partition instances in the Space (primaries and backups). For instance, for a two-partition Space with no backups, <code>/mnt/db1</code> corresponds to the first partition, and <code>/mnt/db2</code> to the second one.</p>
                        <p MadCap:conditions="Version.15-0-born">Should not be used with main-path.</p>
                        <div class="tc-admon-note">
                            <p>The number of backups per partition is zero or one.</p>
                        </div>
                    </td>
                    <td align="left"> </td>
                    <td align="left">
                        <MadCap:conditionalText MadCap:conditions="Version.15-0-died">required</MadCap:conditionalText>
                        <MadCap:conditionalText MadCap:conditions="Version.15-0-born">optional</MadCap:conditionalText>
                    </td>
                </tr>
                <tr>
                    <td align="left">mapping-dir</td>
                    <td align="left">
                        <p align="left">A directory in the file system that contains the "partition to blobstore" mapping file. This file is automatically generated by MemoryXtend. If a partition is relocated, the mapping file is updated.</p>
                        <p MadCap:conditions="Version.15-0-born">Should not be used with main-path.</p>
                    </td>
                    <td align="left"> </td>
                    <td align="left">
                        <MadCap:conditionalText MadCap:conditions="Version.15-0-died">required</MadCap:conditionalText> <MadCap:conditionalText MadCap:conditions="Version.15-0-born">optional</MadCap:conditionalText></td>
                </tr>
                <tr>
                    <td align="left">central-storage</td>
                    <td align="left">Specifies whether the deployment strategy is for <a href="memoryxtend-rocksdb-ssd.html#central-storage">central storage</a> (i.e. SAN configuration) or <a href="memoryxtend-rocksdb-ssd.html#local-storage">local storage</a> on each grid machine (default).</td>
                    <td align="left">false</td>
                    <td align="left">optional</td>
                </tr>
                <tr>
                    <td align="left">db-options</td>
                    <td align="left">Specifies the tuning parameters for the persistent data store in the underlying blobstore. This includes SST formats, compaction settings and flushes. See the <a href="memoryxtend-rocksdb-ssd.html#performance-tuning">Performance Tuning</a> section for details.</td>
                    <td align="left"> </td>
                    <td align="left">optional</td>
                </tr>
                <tr>
                    <td align="left">data-column-family-options</td>
                    <td align="left">Specifies the tuning parameters for the LSM logic and memory tables. See the <a href="memoryxtend-rocksdb-ssd.html#performance-tuning">Performance Tuning</a> section for details.</td>
                    <td align="left"> </td>
                    <td align="left">optional</td>
                </tr>
            </tbody>
        </table>
        <div class="tc-admon-note">
            <p>For an example of how to configure the on-heap cache properties, see the <a href="memoryxtend-overview.html#on-heap-cache">MemoryXtend overview</a> topic.</p>
        </div>
        <div MadCap:conditions="Version.14-5-born">
            <h1>Persistent Volume Storage in Kubernetes</h1>
            <p>This topic describes the Kubernetes storage model and how it is leveraged by <MadCap:variable name="General.CompanyName" /> to support tiered storage that utilizes external persistent memory. This support enables using <MadCap:variable name="General.CompanyName" />'s MemoryXtend feature for SSD in the Kubernetes environment.</p>
            <div class="tc-admon-note">
                <p>Persistent Volume Storage is required for persistent MemoryXtend usage. If you're using MemoryXtend in non-persistent mode, you can skip this section.</p>
            </div>
            <h2>Kubernetes Storage Model</h2>
            <p>The KubeGrid implementation of persistent volume storage utilizes the following Kubernetes entities:</p>
            <ul>
                <li>Container - The Docker container that hosts the Space.</li>
                <li>Pod - Hosts the container, and is essentially the Processing Unit instance, or service in the data grid.</li>
                <li><code>storageClass</code> - A Kubernetes wrapper around the physical storage volume that contains the storage profile. Provides the requested storage defined by the <code>persistentVolumeClaim</code>.</li>
                <li><code>persistentVolumeClaim</code> - The request for Kubernetes to create a <code>persistentVolume</code>. Used to attach (bind) the <code>persistentVolume </code>to the Data Pod.</li>
                <li><code>persistentVolume</code> - A Kubernetes wrapper around the storage that is bound to the Space. </li>
            </ul>
            <p>To enable persistent volume storage, the container definition must include a <code>volumeMount</code>, which is a path that is mapped to the external persistent storage. If a <code>volumeMount</code> is defined, this indicates to the pod that external storage is required. The pod definition must include a <code>persistentVolumeClaim</code>, which defines the capacity of the external storage volume. The pod can then create a <code>persistentVolumeClaim</code> when it receives the <code>volumeMount</code> from the container.</p>
            <p>When a <code>persistentVolumeClaim</code> is created, it communicates to the <code>storageClass</code> that external storage is needed. The <code>storageClass </code>dynamically creates a <code>persistentVolume</code>, which is then attached to the <code>persistentVolumeClaim</code> and its associated pod.</p>
            <p>To summarize, the pod creates a <code>persistentVolumeClaim</code>, which interfaces with the <code>storageClass</code> to create a <code>persistentVolume</code> dedicated to that pod.</p>
            <div class="tc-align-center">
                <p>
                    <img src="../Resources/Static/attachment_files/kubernetes/kubernetes-pvc.png" class="tc-picture80" />
                </p>
            </div>
            <h1>Deploying a Data Pod with MemoryXtend in Kubernetes</h1>
            <p MadCap:conditions="Version.15-0-died">In order to deploy a Processing Unit with tiered storage in Kubernetes, both the pu.xml and pu Helm charts must be configured with the MemoryXtend definitions. </p>
            <p MadCap:conditions="Version.15-0-born">In order to deploy a Processing Unit with tiered storage in Kubernetes, the pu Helm chart must be configured with the MemoryXtend definitions. </p>
            <div MadCap:conditions="Version.15-0-died">
                <h3>Defining the Processing Unit pu.xml</h3>
                <p>The pu.xml contains a <code>paths</code> property. This property defines the mount path for the persistent external storage, or blobstore, used by MemoryXtend. </p>
                <p>When using a <MadCap:variable name="General.CompanyName" /> product in a non-containerized environment, such as the service grid, then you must define a path for each Space instance. For example, when configuring MemoryXtend for a  2:1 high availability environment, four Space instances will be deployed so four paths must be defined in the <code>paths</code> array. </p>
                <MadCap:snippetBlock src="../Resources/Snippets/Content/Kubernetes/k8s-mx-path.flsnp" /><pre><code class="language-xml">&lt;bean id="propertiesConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
    &lt;property name="properties"&gt;
        &lt;props&gt;
            &lt;prop key="space-name"&gt;rocksdb&lt;/prop&gt;
            &lt;prop key="mx-path"&gt;opt/gigaspaces/memoryxtend&lt;/prop&gt;
        &lt;/props&gt;
    &lt;/property&gt;
&lt;/bean&gt;
	
&lt;blob-store:rocksdb-blob-store id="myBlobStore" paths="[${mx-path}]" mapping-dir="${mx-path}/mapping/rocksdbmap"/&gt;

&lt;os-core:embedded-space id="space" name="${space-name}"&gt;
    &lt;os-core:blob-store-data-policy blob-store-handler="myBlobStore" persistent="true"/&gt;								
&lt;/os-core:embedded-space&gt;</code></pre>
            </div>
            <div MadCap:conditions="Version.15-8-died">
                <h3>Installing the Helm Chart</h3>
                <p>
                    <MadCap:conditionalText MadCap:conditions="Version.15-0-died">After the pu.xml has been configured for the MemoryXtend persistent storage option, the next step is installing the Helm chart. </MadCap:conditionalText>Fetch the <MadCap:variable name="General.CompanyName" /> Helm charts as described in<MadCap:xref href="kubernetes-s10-deploying-and-managing-gigaspaces.html"> Deploying and Managing GigaSpaces in Kubernetes</MadCap:xref>. Then use the <code>helm install</code> command to deploy the Processing Unit. The minimum configuration required for MemoryXtend volume is to set the <code>enabled</code> property to <code>true</code>, and the <code>storage</code> property to the required capacity of the external storage. For example:</p>
                <div><pre MadCap:conditions="Version.15-5-died"><code>helm install insightedge-pu --name my-pu --set memoryXtendVolume.enabled=true,memoryXtendVolume.volumeClaimTemplate.storage=10Gi,resourceUrl=http://&lt;my-server&gt;/path/to/my-pu.jar</code></pre>
                    <p MadCap:conditions="Version.15-5-born">
                        <div class="easyui-tabs" plain="true">
                            <div title="Helm 3">
                                <p><pre><code>helm install my-pu insightedge-pu --set   memoryXtendVolume.enabled=true,memoryXtendVolume.volumeClaimTemplate.storage=10Gi,resourceUrl=http://&lt;my-server&gt;/path/to/my-pu.jar</code></pre>
                                </p>
                            </div>
                            <div title="Helm 2">
                                <p><pre><code>helm install insightedge-pu --name my-pu --set memoryXtendVolume.enabled=true,memoryXtendVolume.volumeClaimTemplate.storage=10Gi,resourceUrl=http://&lt;my-server&gt;/path/to/my-pu.jar</code></pre>
                                </p>
                            </div>
                        </div>
                    </p>
                </div>
            </div>
            <div MadCap:conditions="Version.15-8-born">
                <p>Two methods are available to deploy the data pod: using Kubernetes Operator (preferred method), and using Helm charts (deprecated method).</p>
                <h2>Deploying the Data Pod using Kubernetes Operator (preferred method)</h2>
                <p>Follow the procedure described in <MadCap:xref href="kubernetes-s10-deploying-and-managing-gigaspaces.html" MadCap:conditions="Version.15-8-born">Getting Started with GigaSpaces in Kubernetes</MadCap:xref> to install the initial Helm chart and to deploy the processing unit. </p>
                <h2>Deploying the Data Pod using Helm Charts (deprecated method)</h2>
                <p>Fetch the <MadCap:variable name="General.CompanyName" /> Helm charts as described in <MadCap:xref href="kubernetes-data-grid-helm-only.html">Getting Started with GigaSpaces in Kubernetes Using Helm Charts Only</MadCap:xref>, then use the <code>helm install</code> command to deploy the Processing Unit. The minimum configuration required for MemoryXtend volume is to set the <code>enabled</code> property to <code>true</code>, and the <code>storage</code> property to the required capacity of the external storage. For example:</p>
                <div><pre MadCap:conditions="Version.15-5-died"><code>helm install insightedge-pu --name my-pu --set memoryXtendVolume.enabled=true,memoryXtendVolume.volumeClaimTemplate.storage=10Gi,resourceUrl=http://&lt;my-server&gt;/path/to/my-pu.jar</code></pre>
                    <p MadCap:conditions="Version.15-5-born">
                        <div class="easyui-tabs" plain="true">
                            <div title="Helm 3">
                                <p><pre><code>helm install my-pu insightedge-pu --set   memoryXtendVolume.enabled=true,memoryXtendVolume.volumeClaimTemplate.storage=10Gi,resourceUrl=http://&lt;my-server&gt;/path/to/my-pu.jar</code></pre>
                                </p>
                            </div>
                            <div title="Helm 2" MadCap:conditions="Version.16-1-died">
                                <p><pre><code>helm install insightedge-pu --name my-pu --set memoryXtendVolume.enabled=true,memoryXtendVolume.volumeClaimTemplate.storage=10Gi,resourceUrl=http://&lt;my-server&gt;/path/to/my-pu.jar</code></pre>
                                </p>
                            </div>
                        </div>
                    </p>
                </div>
            </div>
            <h2>MemoryXtend Properties</h2>
            <p>The following table describes the properties in the <code>memoryXtendVolume</code> section of the Helm chart.</p>
            <table style="width: 100%;" class="tc-standard">
                <col />
                <col />
                <col />
                <col />
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Description</th>
                        <th>Default Value</th>
                        <th>Required</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>memoryXtendVolume.enabled</code>
                        </td>
                        <td>Indicates whether MemoryXtend for persistent memory is enabled.</td>
                        <td>false</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td><code>memoryXtendVolume.volumeMount.name</code>
                        </td>
                        <td>Name of the <code>volumeMount</code>.</td>
                        <td>mx-volume</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td><code>memoryXtendVolume.volumeMount.mountPath</code>
                        </td>
                        <td>Path that is mapped to the external persistent storage (must be identical to the <code>volumeMount </code>path in the Data Pod configuration).</td>
                        <td><code MadCap:conditions="Version.15-0-died">/opt/gigaspaces/memoryxtend</code><code MadCap:conditions="Version.15-0-born">/opt/gigaspaces/work/memoryxtend</code>
                        </td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td><code>memoryXtendVolume.volumeClaimTemplate.storage</code>
                        </td>
                        <td>Capacity of the external persistent memory volume.</td>
                        <td>&#160;</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td><code>memoryXtendVolume.volumeClaimTemplate.storageClassName</code>
                        </td>
                        <td>The <code>storageClass </code>from which the Data Pod is requesting the external persistent memory volume.</td>
                        <td>&#160;</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td><code>memoryXtendVolume.volumeClaimTemplate.accessModes</code>
                        </td>
                        <td>Mode of access to the external persistent memory volume</td>
                        <td>ReadWriteOnce</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td><code>memoryXtendVolume.volumeClaimTemplate.persistentVolumeReclaimPolicy</code>
                        </td>
                        <td>Define what to do with the <code>persistentVolume </code>after the <code>persistentVolumeClaim </code>is deleted.</td>
                        <td>Delete</td>
                        <td>No</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <h1><a name="off-heap-cache"></a>Off-Heap Cache</h1>
        <p>The data grid can cache the values of indexed fields in the process native (off-heap) memory. This optimizes operations that require only indexed values in order to execute, by fetching the data from off-heap instead of disk. The operations that benefit from this optimization are:</p>
        <ul>
            <li>Read with projection and only indexed fields in query and projection - primary instance optimization</li>
            <li>Take with only indexed fields in query - backup optimization</li>
            <li>Clear with only indexed fields in query - primary and backup instance optimization</li>
        </ul>
        <div class="tc-admon-note">
            <p>This feature increases the overall memory consumption of the Space by several bytes (depending on the indexed fields) per entry.</p>
        </div>
        <p>The off-heap cache is disabled by default. To enable it, simply set the <code>off-heap-cache-memory-threshold</code> property in <code>rocksdb-blob-store</code> to the amount of memory you want to allocate for off-heap caching, for example <code>20m</code>. Use the following sizing units:</p>
        <ul>
            <li><code>b</code> - Bytes</li>
            <li><code>k</code>, <code>kb</code> - Kilobytes</li>
            <li><code>m</code>, <code>mb</code> - Megabytes</li>
            <li><code>g</code>, <code>gb</code> - Gigabytes</li>
        </ul>
        <p>Before any operation that requires memory allocation (write, update, and initial load), the memory manager checks how much of the allocated memory has been used. If the threshold has been breached, an <code>OffHeapMemoryShortageException</code> is thrown. Read, take, and clear operations are always allowed.</p>
        <div class="tc-admon-important">
            <p>If the used memory is below the configured threshold, then a large write operation may exceed the threshold without being blocked or throwing an exception. Users should take this into account when setting the maximum memory size. This behavior is similar to that of the regular <a href="../dev-java/memory-management-overview.html">memory manager</a>.</p>
        </div>
        <p>The amount of used off-heap memory can be tracked using the following:</p>
        <ul>
            <li>Metrics - The <code>space_blobstore_off-heap-cache_used-bytes_total</code> metric, as described on the <a href="metrics-bundled.html#blobstore-operations">Metrics</a> page.</li>
            <li>Administration API - Thru <a href="[%=Links.ApiJavaDoc%]/index.html?org/openspaces/admin/space/SpaceInstanceStatistics.html#getBlobStoreStatistics">SpaceInstanceStatistics.getBlobStoreStatistics()</a></li>
            <li>Web Management Console - In the Space instances view, right-click any of the columns in the table and add the <span class="tc-bold">Used Off-Heap Cache</span> column.</li>
        </ul>
        <p>When a Processing Unit is undeployed or a Space is killed, the off-heap memory manager frees the allocated off-heap memory.</p>
        <p>See the following example:</p><pre><code class="language-java">    public static class TestSpaceClass {

        private Integer id;
        private Integer age;
        private Boolean active;

        public TestSpaceClass() {
        }

        @SpaceId
        public Integer getId() {
            return id;
        }

        public void setId(Integer id) {
            this.id = id;
        }

        @SpaceIndex
        public Integer getAge() {
            return age;
        }

        public void setAge(Integer age) {
            this.age = age;
        }

        public Boolean getActive() {
            return active;
        }

        public void setActive(Boolean active) {
            this.active = active;
        }
    }
</code></pre><pre><code>gigaSpace.readMultiple(new SQLQuery&lt;TestSpaceClass&gt;(TestSpaceClass.class, "age = 3").setProjections("id", "age"));
</code></pre>
        <p>To see whether your query can benefit from this optimization behavior, you can set <code>com.gigaspaces.cache</code> to FINE and look for the following log entry:</p><pre><code class="language-property">2017-11-28 07:57:49,115  FINE [com.gigaspaces.cache] - BlobStore - enabled optimization for query: SELECT * FROM com.gigaspaces.test.blobstore.rocksdb.AbstractRocksDBOptimizationTest$TestSpaceClass 
2017-11-28 07:57:49,115  FINE [com.gigaspaces.cache] - BlobStore - disabled optimization for query: SELECT * FROM com.gigaspaces.test.blobstore.rocksdb.AbstractRocksDBOptimizationTest$TestSpaceClass 
</code></pre>
        <p>When set to FINER, you can see where the entries were fetched from. Look for the following log entry:</p><pre><code class="language-property">2017-11-28 07:57:49,117  FINER [com.gigaspaces.cache] - container [mySpace_container1_1:mySpace] Blobstore- entry loaded from off heap, uid=-1850388785^84^98^0^0
2017-11-28 07:57:49,117  FINER [com.gigaspaces.cache] - container [mySpace_container1_1:mySpace] Blobstore- entry loaded from disk, uid=-1850388785^84^98^0^0
</code></pre>
        <h1><a name="advanced-configuration"></a>Advanced Configuration</h1>
        <p>As part of fine-tuning the MemoryXtend functionality, you can control the balance between memory utilization and system performance. This is useful because there are two ways to update the value of an object in the off-heap memory:</p>
        <ul>
            <li>Free up the old memory allocation, and reallocate new memory.</li>
            <li>Overwrite the old value using the same allocated memory.</li>
        </ul>
        <p>Deleting and reallocating memory takes longer then overwriting the same memory area, but if the size of the new value is smaller then the old value, then the overwrite option leaves part of the original allocated memory underutilized. You can use the <code>BLOBSTORE_OFF_HEAP_MIN_DIFF_TO_ALLOCATE_PROP</code> Space property to control when to trade off system performance for maximizing the memory usage.</p>
        <p>This Space property works as follows: if the oldValueSize - newValueSize &gt; blobstore.off-heap.update_threshold, then delete and reallocate memory for the object. Otherwise overwrite the old object value with the new object value.</p>
        <p>The default threshold is 50B.</p>
        <h2><a name="example"></a>Example</h2>
        <div class="easyui-tabs" plain="true" data-options="">
            <div title="pu.xml" style="padding:10px"><pre MadCap:conditions="Version.14-5-died"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns:blob-store="http://www.openspaces.org/schema/off-heap-blob-store"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-[%=Versions.spring-short%].xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd
       http://www.openspaces.org/schema/off-heap-blob-store http://www.openspaces.org/schema/[%=Versions.product-version-short%]/off-heap-blob-store/openspaces-off-heap-blob-store.xsd"&gt;

    &lt;blob-store:off-heap-blob-store id="offheapBlobstore" memory-threshold="20g"/&gt;

    &lt;os-core:embedded-space id="space" name="mySpace"&gt;
       &lt;os-core:blob-store-data-policy persistent="false" blob-store-handler="offheapBlobstore"/&gt;
       &lt;os-core:properties&gt;
          &lt;props&gt;
             &lt;prop key="blobstore.off-heap.update_threshold"&gt;1M&lt;/prop&gt;
          &lt;/props&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre><pre MadCap:conditions="Version.15-0-born"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns:blob-store="http://www.openspaces.org/schema/off-heap-blob-store"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd
       http://www.openspaces.org/schema/off-heap-blob-store http://www.openspaces.org/schema/[%=Versions.product-version-short%]/off-heap-blob-store/openspaces-off-heap-blob-store.xsd"&gt;

    &lt;blob-store:off-heap-blob-store id="offheapBlobstore" memory-threshold="20g"/&gt;

    &lt;os-core:embedded-space id="space" name="mySpace"&gt;
       &lt;os-core:blob-store-data-policy persistent="false" blob-store-handler="offheapBlobstore"/&gt;
       &lt;os-core:properties&gt;
          &lt;props&gt;
             &lt;prop key="blobstore.off-heap.update_threshold"&gt;1M&lt;/prop&gt;
          &lt;/props&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre>
            </div>
            <div title="Java Code" style="padding:10px"><pre><code class="language-java">// Create off-heap storage driver:
String memoryThreshold = "5g";
BlobStoreStorageHandler blobStore = new OffHeapBlobStoreConfigurer()
        .setMemoryThreshold(memoryThreshold)
        .create();
// Create space with that storage driver:
String spaceName = "mySpace";
EmbeddedSpaceConfigurer spaceConfigurer = new EmbeddedSpaceConfigurer(spaceName)
        .cachePolicy(new BlobStoreDataCachePolicy()
                .setBlobStoreHandler(blobStore)
                .setPersistent(false));
spaceConfigurer.addProperty("blobstore.off-heap.update_threshold", "1M");
GigaSpace gigaSpace = new GigaSpaceConfigurer(spaceConfigurer).gigaSpace();
</code></pre>
            </div>
        </div>
        <h1><a name="deployment-strategies"></a>Deployment Strategies</h1>
        <h2><a name="local-storage"></a>Local Storage</h2>
        <p>This configuration allows each Space partition instance (primary or backup) to use a machine-local storage device (SSD/HDD). With this approach, data locality is leveraged so that the devices local to the machine are used for reads/writes. The local storage deployment strategy provides an easy way to implement a "local persistent store" (also known as native persistence) pattern.</p>
        <div class="tc-align-center">
            <p>
                <img src="../Resources/Static/attachment_files/blobstore/memoryxtend-local-storage.png" alt="image" class="tc-picture80" />
            </p>
        </div>
        <h2><a name="central-storage"></a>Central Storage</h2>
        <p>This deployment strategy works well with <a href="http://en.wikipedia.org/wiki/Storage_area_network" target="_blank">storage area networks (SAN)</a>, which means that the disk drive devices are installed in a remote storage array but behave as if they're attached to the local machine. Most storage networks use the iSCSI or Fibre Channel protocol for communication between servers and disk drive devices. This configuration breaks the coupling between a partition instance and a local machine device, allowing seamless relocation of partitions across data grid machines.</p>
        <div class="tc-align-center">
            <p>
                <img src="../Resources/Static/attachment_files/blobstore/memoryxtend-central-storage.png" alt="image" class="tc-picture80" />
            </p>
        </div>
        <p>Tiering storage between Space partition instances and attached storage can be applied across one or more storage arrays, as shown in the configurations below:</p>
        <h3><a name="single-storage-array"></a>Single Storage Array</h3>
        <table class="tc-borderless">
            <tr>
                <td style="width:80%;">
                    <p>The following example deployes a 2-partition Space with a single backup (2,1) in the following manner:</p>
                    <ul>
                        <li><code>/mnt/db1</code> will be mounted to the 1st primary.</li>
                        <li><code>/mnt/db2</code> will be mounted to the 2nd primary.</li>
                        <li><code>/mnt/db3</code> will be mounted to the 1st backup.</li>
                        <li><code>/mnt/db4</code> will be mounted to the 2nd backup.</li>
                    </ul>
                </td>
                <td style="width:20%;">
                    <p>
                        <img src="../Resources/Static/attachment_files/blobstore/rockdb2.png" class="tc-thumbnail" />
                    </p>
                </td>
            </tr>
        </table><pre><code class="language-xml">&lt;blob-store:rocksdb-blob-store id="myBlobStore" paths="[/mnt/db1,/mnt/db2,/mnt/db3,/mnt/db4]"/&gt;
</code></pre>
        <h3><a name="dual-storage-array"></a>Dual Storage Array</h3>
        <table class="tc-borderless">
            <tr>
                <td style="width:80%;">
                    <p>The following example deploys a 2-partition Space with a single backup (2,1) in the following manner:</p>
                    <ul>
                        <li><code>/mnt1/db1</code> will be mounted to the 1st primary.</li>
                        <li><code>/mnt1/db2</code> will be mounted to the 2nd primary.</li>
                        <li><code>/mnt2/db1</code> will be mounted to the 1st backup.</li>
                        <li><code>/mnt2/db2</code> will be mounted to the 2nd backup.</li>
                    </ul>
                </td>
                <td style="width:20%;">
                    <p>
                        <img src="../Resources/Static/attachment_files/blobstore/rockdb3.png" class="tc-thumbnail" />
                    </p>
                </td>
            </tr>
        </table><pre><code class="language-xml">&lt;blob-store:rocksdb-blob-store id="myBlobStore" paths="[/mnt1/db1,/mnt1/db2],[/mnt2/db1,/mnt2/db2]"/&gt;
</code></pre>
        <h1><a name="performance-tuning"></a>Performance Tuning</h1>
        <h2><a name="persistent-data-store-tuning-parameters"></a>Persistent Data Store Tuning Parameters</h2>
        <p>The data grid uses the default DBOptions class <code>com.com.gigaspaces.blobstore.rocksdb.config.XAPDBOptions</code>.</p>
        <div class="tc-admon-note">
            <p>A list of configuration properties can be found in  the <a href="https://github.com/facebook/rocksdb/blob/master/java/src/main/java/org/rocksdb/DBOptionsInterface.java" target="_blank">org.rocksdb.DBOptionsInterface</a> API&#160;documentation.</p>
        </div>
        <table>
            <thead>
                <tr>
                    <th align="left">Property</th>
                    <th align="left">Description</th>
                    <th align="left">Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td align="left">createIfMissing</td>
                    <td align="left">Configure whether to create the database if it is missing. This value is always overrode with <code>true</code>.</td>
                    <td align="left">true</td>
                </tr>
                <tr>
                    <td align="left">maxBackgroundCompactions</td>
                    <td align="left">Specifies the maximum number of concurrent background compaction jobs, submitted to the default LOW priority thread pool. <br /> If you're increasing this, also consider increasing the number of threads in the LOW priority thread pool</td>
                    <td align="left">8</td>
                </tr>
                <tr>
                    <td align="left">maxBackgroundFlushes</td>
                    <td align="left">Specifies the maximum number of concurrent background flush jobs. <br />If you're increasing this, also consider increasing the number of threads in the HIGH priority thread pool.</td>
                    <td align="left">8</td>
                </tr>
                <tr>
                    <td align="left">maxOpenFiles</td>
                    <td align="left">Number of open files that can be used by the database.  You may need to increase this if your database has a large working set. When the value is set to -1, files that are opened are always kept open.</td>
                    <td align="left">-1</td>
                </tr>
                <tr>
                    <td align="left">tableFormatConfig</td>
                    <td align="left">Set the configuration for the table format. <br /> The default is BlockBasedTableConfig with <ul><li>noBlockCache = opposite of <code>useCache</code></li><li>blockCacheSize = <code>cacheSize</code></li><li>blockSize = <code>blockSize</code></li><li> filter = BloomFilter(10,false)</li><li>formatVersion = 0</li></ul>The highlighted values are taken from the <code>rocksdb-blob-store</code> namespace / <code>RocksDBBlobStoreConfigurer</code> if provided, otherwise the following defaults are used: <ul><li>useCache = true</li><li>cacheSize = 100MB</li><li>blockSize = 16KB</li></ul>If a custom tableFormatConfig is provided, the values from the namespace/configurer are ignored.</td>
                    <td align="left">&#160;</td>
                </tr>
            </tbody>
        </table>
        <h2><a name="lsm-logic-and-memtables-tuning-parameters"></a>LSM Logic and MemTables Tuning Parameters</h2>
        <p>Below are the values for the default class <code>com.com.gigaspaces.blobstore.rocksdb.config.XAPColumnFamilyOptions</code>.</p>
        <div class="tc-admon-note">
            <p>A list of configuration properties can be found in  the <a href="https://github.com/facebook/rocksdb/blob/v5.5.1/java/src/main/java/org/rocksdb/AdvancedColumnFamilyOptionsInterface.java">org.rocksdb.ColumnFamilyOptionsInterface</a> API&#160;documentation.</p>
        </div>
        <table>
            <thead>
                <tr>
                    <th align="left">Property</th>
                    <th align="left">Description</th>
                    <th align="left">Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td align="left">writeBufferSize</td>
                    <td align="left">Amount of data to build up in memory (backed by an unsorted log on disk) <br />before converting to a sorted on-disk file. Should be in bytes.</td>
                    <td align="left">64 MB</td>
                </tr>
                <tr>
                    <td align="left">levelZeroSlowdownWritesTrigger</td>
                    <td align="left">Soft limit on number of level-0 files. The data grid begins to slow down writes at this point. <br />A value &lt; 0 means that no writing slowdown is triggered by the number of files in level-0.</td>
                    <td align="left">8</td>
                </tr>
                <tr>
                    <td align="left">maxWriteBufferNumber</td>
                    <td align="left">The maximum number of write buffers that are built up in memory.</td>
                    <td align="left">4</td>
                </tr>
                <tr>
                    <td align="left">targetFileSizeBase</td>
                    <td align="left">The target file size for compaction. Should be in bytes.</td>
                    <td align="left">64 MB</td>
                </tr>
                <tr>
                    <td align="left">softPendingCompactionBytesLimit</td>
                    <td align="left">The soft limit to impose on compaction.</td>
                    <td align="left">0</td>
                </tr>
                <tr>
                    <td align="left">hardPendingCompactionBytesLimit</td>
                    <td align="left">The hard limit to impose on compaction.</td>
                    <td align="left">0</td>
                </tr>
                <tr>
                    <td align="left">levelCompactionDynamicLevelBytes</td>
                    <td align="left">If true, RocksDB will pick the target size of each level dynamically.</td>
                    <td align="left">false</td>
                </tr>
                <tr>
                    <td align="left">maxBytesForLevelBase</td>
                    <td align="left">The upper limit of the total size of level-1 files, in bytes.</td>
                    <td align="left">512 MB</td>
                </tr>
                <tr>
                    <td align="left">compressionPerLevel</td>
                    <td align="left">Sets the compression policy for each level.</td>
                    <td align="left">[NO_COMPRESSION, <br /> NO_COMPRESSION, <br />SNAPPY_COMPRESSION]</td>
                </tr>
                <tr>
                    <td align="left">mergeOperatorName</td>
                    <td align="left">Sets the merge operator to be used for merging two merge operands of the same key.</td>
                    <td align="left">put</td>
                </tr>
                <tr>
                    <td align="left"><a name="ssd-fsync"></a>fsync</td>
                    <td align="left">By default, each write returns after the data is pushed to the operating system. The transfer from operating system memory to the underlying persistent storage happens asynchronously. When sync is configured to true, each write operation doesn't return until the data being written has been pushed all the way to persistent storage. <br /> This parameter should be set to true while storing data to file systems like ext3, which can lose files after a reboot. <br />If this property is set, the <code>fsync</code> that is passed to the <code>rocksdb-blob-store</code> namespace/<code>RocksDBBlobStoreConfigurer</code> (if any) is ignored.</td>
                    <td align="left">false</td>
                </tr>
            </tbody>
        </table>
        <h2><a name="examples"></a>Examples</h2>
        <div class="easyui-tabs" plain="true" data-options="">
            <div title="Namespace" style="padding:10px"><pre MadCap:conditions="Version.14-5-died"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns:blob-store="http://www.openspaces.org/schema/rocksdb-blob-store"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-[%=Versions.spring-short%].xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd
       http://www.openspaces.org/schema/rocksdb-blob-store http://www.openspaces.org/schema/[%=Versions.product-version-short%]/rocksdb-blob-store/openspaces-rocksdb-blobstore.xsd"&gt;

    &lt;bean id="dbOptions" class="com.gigaspaces.blobstore.rocksdb.config.XAPDBOptions"&gt;
        &lt;!-- This will override the default of 8 --&gt;
        &lt;property name="maxBackgroundCompactions" value="4" /&gt;
        &lt;property name="maxBackgroundFlushes" value="4" /&gt;
    &lt;/bean&gt;
    
    &lt;bean id="dataColumnFamilyOptions" class="com.gigaspaces.blobstore.rocksdb.config.XAPColumnFamilyOptions"&gt;
        &lt;property name="maxBytesForLevelMultiplier" value="20"/&gt;
    &lt;/bean&gt;

    &lt;blob-store:rocksdb-blob-store id="myBlobStore" fsync="false"
        cache-size-mb="100" block-size-kb="16"
        db-options="dbOptions" data-column-family-options="dataColumnFamilyOptions"
        paths="[/tmp/rocksdb,/tmp/rocksdb2]" mapping-dir="/tmp/mapping"/&gt;

    &lt;os-core:embedded-space id="space" space-name="mySpace" &gt;
        &lt;os-core:blob-store-data-policy blob-store-handler="myBlobStore"/&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre><pre MadCap:conditions="Version.15-0-born"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:os-core="http://www.openspaces.org/schema/core"
       xmlns:blob-store="http://www.openspaces.org/schema/rocksdb-blob-store"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.openspaces.org/schema/core http://www.openspaces.org/schema/[%=Versions.product-version-short%]/core/openspaces-core.xsd
       http://www.openspaces.org/schema/rocksdb-blob-store http://www.openspaces.org/schema/[%=Versions.product-version-short%]/rocksdb-blob-store/openspaces-rocksdb-blobstore.xsd"&gt;

    &lt;bean id="dbOptions" class="com.gigaspaces.blobstore.rocksdb.config.XAPDBOptions"&gt;
        &lt;!-- This will override the default of 8 --&gt;
        &lt;property name="maxBackgroundCompactions" value="4" /&gt;
        &lt;property name="maxBackgroundFlushes" value="4" /&gt;
    &lt;/bean&gt;
    
    &lt;bean id="dataColumnFamilyOptions" class="com.gigaspaces.blobstore.rocksdb.config.XAPColumnFamilyOptions"&gt;
        &lt;property name="maxBytesForLevelMultiplier" value="20"/&gt;
    &lt;/bean&gt;

    &lt;blob-store:rocksdb-blob-store id="myBlobStore" fsync="false"
        cache-size-mb="100" block-size-kb="16"
        db-options="dbOptions" data-column-family-options="dataColumnFamilyOptions"
        paths="[/tmp/rocksdb,/tmp/rocksdb2]" mapping-dir="/tmp/mapping"/&gt;

    &lt;os-core:embedded-space id="space" space-name="mySpace" &gt;
        &lt;os-core:blob-store-data-policy blob-store-handler="myBlobStore"/&gt;
    &lt;/os-core:embedded-space&gt;

    &lt;os-core:giga-space id="gigaSpace" space="space"/&gt;
&lt;/beans&gt;
</code></pre>
            </div>
            <div title="Java Code" style="padding:10px"><pre><code class="language-java">RocksDBBlobStoreConfigurer configurer = new RocksDBBlobStoreConfigurer()
        .setPaths("[/tmp/rocksdb,/tmp/rocksdb2]")
        .setMappingDir("/tmp/mapping")
        .setCacheSizeMB(100)
        .setBlockSizeKB(16)
        .setFsync(false);

XAPDBOptions dbOptions = new XAPDBOptions();
configurer.setDBOptions(dbOptions); // optional

XAPColumnFamilyOptions dataColumnFamilyOptions = new XAPColumnFamilyOptions();
configurer.setDataColumnFamilyOptions(dataColumnFamilyOptions); // optional

RocksDBBlobStoreHandler rocksDBBlobStoreHandler = configurer.create();

BlobStoreDataCachePolicy cachePolicy = new BlobStoreDataCachePolicy();
cachePolicy.setBlobStoreHandler(rocksDBBlobStoreHandler);

EmbeddedSpaceConfigurer embeddedSpaceConfigurer = new EmbeddedSpaceConfigurer("mySpace");
embeddedSpaceConfigurer.cachePolicy(cachePolicy);

gigaSpace = new GigaSpaceConfigurer(embeddedSpaceConfigurer.space()).gigaSpace();
</code></pre>
            </div>
        </div>
    </body>
</html>