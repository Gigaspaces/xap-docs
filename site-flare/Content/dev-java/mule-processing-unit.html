<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
<head></head>
<body>
<h1>Processing Unit</h1>
  

<p>XAP allows to configure, package and deploy a <a href="the-processing-unit-overview.html">Processing Unit</a>. The OpenSpaces Mule integration allows you to run a pure Mule application (with or without OpenSpaces special extension points and transports) as a Processing Unit.</p>

<h1><a name="configuration">&#160;</a>Configuration</h1>

<p>In order to run Mule as a Processing Unit within the <code>pu.xml</code> file (which is a Spring application context), the following needs to be defined:</p>

<pre><code class="language-xml">&lt;bean class="org.openspaces.esb.mule.pu.OpenSpacesMuleContextLoader"&gt;
    &lt;property name="location" value="/META-INF/spring/mule.xml"/&gt;
&lt;/bean&gt;
</code></pre>

<p>In the example above, the <code>OpenSpacesMuleContextLoader</code> loads a Mule application as defined in the <code>mule.xml</code> configuration file. The <code>location</code> parameter is optional and defaults to the value specified in the example above.</p>

<h1><a name="packaging">&#160;</a>Packaging</h1>

<p>Packaging of the Processing Unit should follow the <a href="the-processing-unit-structure-and-configuration.html">Processing Unit structure</a>.</p>

<div class="tc-admon-note">
  
  <p>When deploying a Processing Unit into the <a href="deploying-onto-the-service-grid.html">SLA-driven container</a>, Mule JAR files should be "installed" into the XAP installation (on each node). The following minimum set of JARs need to be copied into <code>&amp;lt;XAP Root&amp;gt;\lib\platform\mule</code> (if the Mule directory does not exists, create it).</p>
</div>

<ul>
<li><p>Download Mule 3.7 distribution from <a href="https://www.mulesoft.org/download-mule-esb-community-edition">mule's website</a> and extract the file.</p></li>

<li><p>Copy the following JAR files from <code>&lt;Mule Root&gt;\lib\mule</code> to <code>&amp;lt;XAP Root&amp;gt;\lib\platform\mule</code>:
<code>mule-commons</code>, <code>mule-core</code>, <code>mule-core-tests</code>, <code>mule-module-annotations</code>, <code>mule-module-client</code>, <code>mule-module-jbossts</code>, <code>mule-module-spring-config</code>, <code>mule-module-spring-extras</code>,  <code>mule-mvel2-2.1.9-MULE-003</code>, <code>mule-transport-http</code>, <code>mule-transport-quartz</code>, <code>mule-transport-stdio</code>, <code>mule-transport-vm</code> . Other transports (if used) should be copied as well.</p></li>

<li><p>Copy the following JAR files from <code>&lt;Mule Root&gt;\lib\opt</code> to <code>&amp;lt;XAP Root&amp;gt;\lib\platform\mule</code>:
<code>commons-beanutils</code>, <code>commons-io</code>, <code>commons-lang</code>, <code>dom4j</code>, <code>guava</code>, <code>jaxen</code>, <code>quartz</code>, <code>uuid</code>, <code>jgrapht-jdk1.5</code>. Other required JAR files can be copied as well (or they can be put in the Processing Unit <code>lib</code> directory).</p></li>

<li><p>Copy the following JAR files from <code>&lt;Mule Root&gt;\lib\boot</code> to <code>&amp;lt;XAP Root&amp;gt;\lib\platform\mule</code>:
<code>commons-cli</code>, <code>log4j</code>, <code>mule-module-logging</code>, <code>wrapper</code>. Other required JAR files can be copied as well (or they can be put in the Processing Unit <code>lib</code> directory).</p></li>
</ul>

<div class="tc-admon-note">
  
  <p>The required mule jar files can also be placed within the processing unit <code>lib</code> directory, without "installing" mule into each GSC node installation.</p>
</div>

<h4><a name="packaging-for-mule-example">&#160;</a>Packaging for Mule example</h4>

<p>In the <a href="/sbp/mule-esb-example.html">Mule ESB example</a>, the following jars are required and should be placed under &lt;XAP Root&gt;\lib\platform\mule</p>

<pre><code class="language-bash">commons-beanutils-1.8.0.jar
commons-cli-1.2.jar
commons-io-1.4.jar
commons-lang-2.4.jar
dom4j-1.6.1.jar
guava-16.0.1.jar
jaxen-1.1.1.jar
jgrapht-jdk1.5-0.7.3.jar
log4j-1.2.16.jar
mule-common-[%=Versions.mule%].jar
mule-core-[%=Versions.mule%].jar
mule-core-[%=Versions.mule%]-tests.jar
mule-module-annotations-[%=Versions.mule%].jar
mule-module-client-[%=Versions.mule%].jar
mule-module-jbossts-[%=Versions.mule%].jar
mule-module-logging-[%=Versions.mule%].jar
mule-module-spring-config-[%=Versions.mule%].jar
mule-module-spring-extras-[%=Versions.mule%].jar
mule-mvel2-2.1.9-MULE-003.jar
mule-transport-http-[%=Versions.mule%].jar
mule-transport-quartz-[%=Versions.mule%].jar
mule-transport-stdio-[%=Versions.mule%].jar
mule-transport-vm-[%=Versions.mule%].jar
quartz-1.8.5.jar
uuid-3.4.0.jar
wrapper-3.2.3.jar
</code></pre>

<h1><a name="running-deploying">&#160;</a>Running/Deploying</h1>

<p>Once the Processing Unit is packaged, it can be run using the different options that come with OpenSpaces:</p>

<ul>
<li><a href="running-in-standalone-mode.html">Standalone</a></li>
<li><a href="deploying-onto-the-service-grid.html">SLA driven container</a></li>
</ul>

</body>
</html>